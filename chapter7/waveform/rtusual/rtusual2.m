
% close all;

series = [         
         0         0         0         0         0         0         0         0         0 ;
    0.0714   -0.1590    2.2443         0   -3.8896   -0.1590    2.2443         0   -3.8896  ;
    0.1429   -0.3055    4.8344   -0.5563   -7.4600   -0.3055    4.8344   -0.5563   -7.4600  ;
    0.2143   -2.1211    7.0724   -2.4586   -7.4600   -2.1211    7.0724   -2.4586   -7.4600  ;
    0.2857   -3.9860    8.2798   -2.7570   -7.4600   -3.9860    8.2798   -2.7570   -7.4600  ;
    0.3571   -5.7975    8.8835   -2.3611   -7.4600   -5.7975    8.8835   -2.3611   -7.4600  ;
    0.4286   -7.6074    9.2712   -1.7712   -7.4600   -7.6074    9.2712   -1.7712   -7.4600  ;
    0.5000   -9.6264    9.6372   -1.1775   -7.4600   -9.6264    9.6372   -1.1775   -7.4600  ;
    0.5714  -12.1203   10.1265   -0.6038   -7.4600  -12.1203   10.1265   -0.6038   -7.4600  ;
    0.6429   -8.9630    8.9014    4.5705  -13.2760   -8.9630    8.9014    4.5705  -13.2760  ;
    0.7143   -8.9630    7.9985    5.0992  -12.7040   -8.9630    7.9985    5.0992  -12.7040  ;
    0.7857   -8.9630    7.0732    4.9900  -11.5388   -8.9630    7.0732    4.9900  -11.5388  ;
    0.8571   -8.9630    6.2100    4.7400  -10.4100   -8.9630    6.2100    4.7400  -10.4100   ;  
    0.9286   -8.9630    5.3700    4.5400   -9.4700   -8.9630    5.3700    4.5400   -9.4700  ;
    1.0000   -8.9630    4.4591    4.5000   -8.7400   -8.9630    4.4591    4.5000   -8.7400 ; 
    ];
% % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % % %
series(1:end,2:end) = -1*series(1:end,2:end);



% n = 1;
% tt = ((0:0.11:29)*2-1);
% dd = load('fullscan.txt');
% % plot(tt,dd(:,n)/max(abs(dd(:,n))),'k','LineWidth',2)
% plot(tt,dd(:,n),'k','LineWidth',2)
% xlim([min(data(:,1)) 0.065]/0.001)
% % ylim([-10.5 0.5])
% xlabel('Time (ms)','FontSize',14)
% ylabel('Voltage change (V)','FontSize',14)
% set(gca,'FontSize',14)
% 
% set(gca,'YTick',[-10 -9 -8 -7 -6 -5 -4 -3 -2 -1 0],'YTickLabel',{'-10';'';'-8';'';'-6';'';'-4';'';'-2';'';'0' });

n = 200;
x = linspace(0,1,n)
sv = zeros(4,n);
for v = 1:4;
sv(v,:) = 1*interp1(series(:,1),series(:,v+1),x,'cubic');
end
x = x*360;
vo = [-8 6.18 0 -8]
plot(x,sv(4,:)+vo(4),'-.',x,sv(3,:)+vo(3),'--',x,sv(2,:)+vo(2),':',x,sv(1,:)+vo(1),'-','LineWidth',2)
legend('#1','#2','#3','#4','Location','NE')
xlim([0 360])
xlabel('Shuttle distance from centre (\mum)','FontSize',14)
ylabel('Voltage on DC electrode','FontSize',14)
set(gca,'FontSize',14)
set(gca,'YTick',[-9 -8 -7 -6 -5 -4 -3 -2 -1 0 1 2 3 4 5 6 7 8 9 ],'YTickLabel','|-8||-6||-4||-2||0||2||4||6||8')
ylim([-9 9])


out = [x(:) sv(4,:)'+vo(4) sv(3,:)'+vo(3) sv(2,:)'+vo(2) sv(1,:)'+vo(1)];
save 'rtusual.dat' 'out' '-ascii'